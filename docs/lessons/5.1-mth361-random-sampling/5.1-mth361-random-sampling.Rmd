---
title: "Random Sampling"
subtitle: "Applied Statistics"
author: "MTH-361A | Spring 2025 | University of Portland"
date: "February 10, 2025"
output:
  slidy_presentation:
    font_adjustment: +5
    footer: "| MTH-361A Spring 2025 | <a href='../../index.html'>Back to the Course Website</a>"
    css: ../_style.css
bibliography: ../../references.bib
csl: ../../apa.csl
nocite: '@*'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r message=FALSE, warning=FALSE}
library(gridExtra)
```

## Objectives

:::: {.column width=15%}
::::

:::: {.column width=70%}
- **Develop an understanding of the long-run average**
- **Introduce random sampling simulations in R**
- **Activity: Simulate Multiple Bernoulli Trials**
::::

:::: {.column width=15%}
::::

## Previously... (1/2)

**Random Variables (R.V.)**

A **random variable** is a numerical outcome of a random experiment. It assigns a number to each possible outcome in a sample space.

In other words, a random variable is **a function that maps the sample space into real numbers**.

**Types**

* *Discrete Random Variable:* Takes on a countable number of values.
* *Continuous Random Variable:* Takes on any value in an interval.

## Previously... (2/2)

**The Expected Value**

The **expected value (mean)** of a *discrete r.v.* $X$ is given by $$\text{E}(X) = \sum_{i=1}^n x_i P(x_i)$$ where $x_i$ for $i = 1, 2, \cdots, x_n$ are the possible outcomes of $X$ with probability $P(x_i)$, and $n$ is the total possible outcomes.

**The Variance**

The **Variance** measures the **spread** of a *discrete r.v.* $X$ around its expected value: $$\text{Var}(X) = \text{E}\left(X^2 \right) - \left( \text{E}(X) \right)^2$$ where $\text{E}\left(X^2 \right)$ is called the 2nd raw moment or $$\text{E}(X^2) = \sum_{i=1}^n x_i^2 P(x_i)$$

## The Bernoulli Distribution

A **Bernoulli r.v.** represents a single experiment with two possible outcomes: success (1) with probability $p$ and failure (0) with probability $1-p$.

$$X \sim \text{Bern}(p)$$

The **Bernoulli distribution** is a **probability function** that computes the probability of the Bernoulli random variable.

The **probability mass function** of the *Bernoulli r.v.* is give by $$P(X = x) = p^x (1-p)^{1-x}, \ \ x \in \{0,1\}$$ where $p$ is the parameter (also the probability of "success").

## Simulating Bernoulli Trials

**Load Packages**

```{r eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
```

**Bournoulli Trials**

A **Bernoulli trial** is a random experiment with two possible outcomes: success (1) or failure (0).

```{r eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE}
# set parameters
set.seed(42)  # for reproducibility
n <- 10       # number of trials
x <- c("0","1")   # possible outcomes ("1"="success","0"="failure")
p <- 0.6      # probability of success

# simulate n Bernoulli trials with success probability p
samples <- sample(x,size=n,prob=c(1-p,p),replace=TRUE)

# convert samples into tibble form
samples_tib <- tibble(x=samples) %>% 
  group_by(x) %>% 
  summarise(count=n(),
            proportion=count/n)
samples_tib
```

## Simulating Bernoulli Trials: Sample Proportions

We can visualize the sample proportions of the simulated Bernoulli trials using a **bar plot**.

```{r eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE, fig.align='center',fig.width=4,fig.height=2,out.width='60%'}
ggplot(samples_tib,aes(x=x,y=proportion)) + 
  geom_col() + 
  ylim(0,1)
```

## Visualizing the Bernoulli Distribution

The **Bernoulli distribution** can be visualized using the vertical line plot.

```{r eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center',fig.width=4,fig.height=2,out.width='60%'}
# set Bernouli parameter
p <- 0.6

# set PMF of the Bernoulli r.v.
pmf <- tibble(x=c("0","1"),
              p=c(1-p,p))

# plot the Bernoulli distribution
p1 <- ggplot(pmf,aes(x=x,y=p)) + 
  geom_point(size=3,color="#229954") + 
  geom_segment(aes(x=x,xend=x,
                   y=c(0,0), yend=p),
               color="#229954") + 
  ggtitle("Bernoulli PMF") + 
  ylim(0,1) + 
  scale_x_discrete(labels=c("0"="0","1"="1"))
p1
```

## The Long-Run Average Outcome: More Samples

```{r eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE}
# set parameters
set.seed(42)  # for reproducibility
n <- 1000       # number of trials
x <- c("0","1")   # possible outcomes ("1"="success","0"="failure")
p <- 0.6      # probability of success

# simulate n Bernoulli trials with success probability p
samples <- sample(x,size=n,prob=c(1-p,p),replace=TRUE)

# convert samples into tibble form
samples_tib <- tibble(x=samples) %>% 
  group_by(x) %>% 
  summarise(count=n(),
            proportion=count/n)
samples_tib
```

## The Long-Run Average Outcome: Comparing to PMF

```{r eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center',fig.width=4,fig.height=2,out.width='60%'}
p2 <- ggplot(samples_tib,aes(x=x,y=proportion)) + 
  geom_col() +
  ggtitle("Bernoulli Trials") + 
  ylim(0,1)
grid.arrange(p1,p2,ncol=2)
```

## Activity: Simulate Multiple Bernoulli Trials

1. Log-in to Posit Cloud and open the R Studio assignment *M 2/10 - Simulate Multiple Bernoulli Trials*.
2. Make sure you are in the current working directory. Rename the `.Rmd` file by replacing `[name]` with your name using the format `[First name][Last initial]`. Then, open the `.Rmd` file.
3. Change the author in the YAML header.
4. Read the provided instructions.
5. Answer all exercise problems on the designated sections.

## References

::: {#refs}
:::
